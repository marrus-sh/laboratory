// Generated by CoffeeScript 1.12.4
(function(){"use strict";/*
  
      ............. LABORATORY ..............
  
      A client-side API for Mastodon, a free,
         open-source social network server
                - - by Kibigo! - -
  
          Licensed under the MIT License.
             Source code available at:
      https://github.com/marrus-sh/laboratory
  
                  Version 0.3.0
   */
var Application,Attachment,Authorization,Client,Enumeral,Exposed,Failure,Laboratory,LaboratoryEvent,Post,Profile,Rolodex,Store,Timeline,dispatch,fn,forget,listen,prop,run,serverRequest,hasProp={}.hasOwnProperty;Laboratory={"ℹ":"https://github.com/marrus-sh/laboratory","Nº":3},function(){var Mommy,code;(code=(location.search.match(/code=([^&]*)/)||[])[1])&&(Mommy=window.opener.Laboratory)&&Mommy.dispatch("LaboratoryAuthorizationGranted",{window:window,code:code})}(),Exposed={ready:!1,auth:null},fn=function(prop){return Object.defineProperty(Laboratory,prop,{get:function(){return Exposed[prop]},enumerable:!0})};for(prop in Exposed)fn(prop);!function(){var CustomEvent;if("function"!=typeof CustomEvent)CustomEvent=function(event,params){var e;return params=params||{bubbles:!1,cancelable:!1,detail:void 0},e=document.createEvent("CustomEvent"),e.initCustomEvent(event,params.bubbles,params.cancelable,params.detail),e},CustomEvent.prototype=window.Event.prototype,Object.freeze(CustomEvent),Object.freeze(CustomEvent.prototype)}(),serverRequest=function(method,location,data,accessToken,onComplete,onError){var callback,contents,key,request,subvalue,value;"GET"!==method&&"POST"!==method&&"DELETE"!==method||(location=String(location),data=Object(data),request=new XMLHttpRequest,contents="POST"===method&&"undefined"!=typeof FormData&&null!==FormData&&data instanceof FormData?data:function(){var results;results=[];for(key in data)null!=(value=data[key])&&(value instanceof Array?results.push(function(){var i,len,results1;for(results1=[],i=0,len=value.length;i<len;i++)subvalue=value[i],results1.push(encodeURIComponent(key)+"[]="+encodeURIComponent(subvalue));return results1}().join("&")):results.push(encodeURIComponent(key)+"="+encodeURIComponent(value)));return results}().join("&").replace(/%20/g,"+"),""!==contents&&"POST"!==method&&(location+=(location.indexOf("?")!==-1?"&":"?")+contents),request.open(method,location),"POST"!==method||"undefined"!=typeof FormData&&null!==FormData&&contents instanceof FormData||request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),accessToken&&request.setRequestHeader("Authorization","Bearer "+accessToken),callback=function(){var params,ref,ref1,response,status;switch(request.readyState){case 0:break;case 1:dispatch("LaboratoryRequestOpen",request);break;case 2:case 3:dispatch("LaboratoryRequestUpdate",request);break;case 4:switch(status=request.status,response=function(){try{return request.responseText?JSON.parse(request.responseText):null}catch(error){return{error:"The response could not be parsed."}}}(),params={status:status,url:location,prev:((null!=(ref=request.getResponseHeader("Link"))?ref.match(/<\s*([^,]*)\s*>\s*;[^,]*[;\s]rel="?prev(?:ious)?"?/):void 0)||[])[1],next:((null!=(ref1=request.getResponseHeader("Link"))?ref1.match(/<\s*([^,]*)\s*>\s*;[^,]*[;\s]rel="?next"?/):void 0)||[])[1]},!1){case!(200<=status&&status<=205):null!=(null!=response?response.error:void 0)?(onError(response,data,params),dispatch("LaboratoryRequestError",request)):(onComplete(response,data,params),dispatch("LaboratoryRequestComplete",request));break;default:onError(response,data,params),dispatch("LaboratoryRequestError",request)}request.removeEventListener("readystatechange",callback)}},request.addEventListener("readystatechange",callback),"POST"===method?request.send(contents):request.send())},Laboratory.Enumeral=Enumeral=null,function(){var generator;generator=!1,Laboratory.Enumeral=Enumeral=function(value){if(!generator)throw new Error("Laboratory Error : The `Enumeral()` constructor cannot be called directly—try `Enumeral.generate()` instead");if(!(this&&this instanceof Enumeral))throw new Error("Laboratory Error : `Enumeral()` must be called as a constructor");return this.value=0|value,Object.freeze(this)},Object.defineProperty(Enumeral,"prototype",{value:Object.freeze({toString:function(){return"Enumeral("+this.value+")"},toSource:function(){return"Enumeral("+this.value+")"},valueOf:function(){return this.value}})}),Enumeral.generate=function(data){var byValue,enumeral,type,value;type=function(n){return Enumeral.call(this,n)},type.prototype=Object.create(Enumeral.prototype),generator=!0,byValue={};for(enumeral in data)hasProp.call(data,enumeral)&&(value=data[enumeral],null==byValue[value]&&(type[enumeral]=new type(value),byValue[value]=type[enumeral]));return generator=!1,type.fromValue=function(n){return byValue[0|n]},Object.freeze(type)}}(),Laboratory.Application=Application=function(data){if(!(this&&this instanceof Application))throw new Error("Laboratory Error : `Application()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Application()` was called without any `data`");return this.name=data.name,this.href=data.website,Object.freeze(this)},Object.defineProperty(Application,"prototype",{value:Object.freeze({})}),Laboratory.Attachment=Attachment=function(data){if(!(this&&this instanceof Attachment))throw new Error("Laboratory Error : `Attachment()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Attachment()` was called without any `data`");return this.id=Number(data.id),this.href=String(data.url),this.preview=String(data.preview_url),this.type=function(){switch(data.type){case"image":return Attachment.Type.IMAGE;case"video":return Attachment.Type.VIDEO;case"gifv":return Attachment.Type.GIFV;default:return Attachment.Type.UNKNOWN}}(),Object.freeze(this)},Object.defineProperty(Attachment,"prototype",{value:Object.freeze({})}),Attachment.Type=Enumeral.generate({UNKNOWN:0,PHOTO:1,VIDEO:2,GIFV:3}),Laboratory.Authorization=Authorization=function(data,origin,me){var scopes;if(!(this&&this instanceof Authorization))throw new Error("Laboratory Error : `Authorization()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Authorization()` was called without any `data`");return this.origin=String(origin),this.accessToken=String(data.access_token),this.datetime=new Date(data.created_at),this.scope=Authorization.Scope.fromValue(Authorization.Scope.READ*((scopes=String(data.scope).split(/[\s\+]+/g)).indexOf("read")!==-1)+Authorization.Scope.WRITE*(scopes.indexOf("write")!==-1)+Authorization.Scope.FOLLOW*(scopes.indexOf("follow")!==-1)),this.tokenType=String(data.tokenType),this.me=+me,Object.freeze(this)},Object.defineProperty(Authorization,"prototype",{value:Object.freeze({})}),Authorization.Scope=Enumeral.generate({NONE:0,READ:1,WRITE:2,READWRITE:3,FOLLOW:4,READFOLLOW:5,WRITEFOLLOW:6,READWRITEFOLLOW:7}),Laboratory.Client=Client=function(data,params,origin){if(!(this&&this instanceof Client))throw new Error("Laboratory Error : `Client()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Client()` was called without any `data`");return this.origin=origin,this.name=params.client_name,this.id=data.id,this.clientID=data.client_id,this.clientSecret=data.client_secret,this.scope=Authorization.Scope.fromValue(Authorization.Scope.READ*(params.scopes.indexOf("read")!==-1)+Authorization.Scope.WRITE*(params.scopes.indexOf("write")!==-1)+Authorization.Scope.FOLLOW*(params.scopes.indexOf("follow")!==-1)),this.redirect=data.redirect_uri,Object.freeze(this)},Object.defineProperty(Client,"prototype",{value:Object.freeze({})}),Laboratory.Failure=Failure=function(data,request,code){if(!(this&&this instanceof Failure))throw new Error("Laboratory Error : `Failure()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Failure()` was called without any `data`");return this.request=String(request),this.error=String(data.error),isFinite(this.code=Number(code))||(this.code=null),Object.freeze(this)},Object.defineProperty(Failure,"prototype",{value:Object.freeze({})}),Laboratory.Post=Post=function(data){var fromID,getProfile,item,profiles;if(!(this&&this instanceof Post))throw new Error("Laboratory Error : `Post()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Post()` was called without any `data`");if(profiles=Store.profiles,getProfile=function(id){return profiles[id]},null!=data.type){if(this.id=data.id,fromID=data.account.id,!data.status){switch(Object.defineProperty(this,"author",{get:getProfile.bind(this,fromID),enumerable:!0}),data.type){case"follow":this.type=Post.Type.FOLLOW;break;default:this.type=Post.Type.NOTIFICATION}return Object.freeze(this)}switch(data.type){case"reblog":this.type=Post.Type.REBLOG,Object.defineProperty(this,"rebloggedBy",{get:getProfile.bind(this,fromID),enumerable:!0});break;case"favourite":this.type=Post.Type.FAVOURITE,Object.defineProperty(this,"favouritedBy",{get:getProfile.bind(this,fromID),enumerable:!0});break;case"mention":this.type=Post.Type.MENTION;break;default:this.type=Post.Type.REACTION}data=data.status}else this.type=Post.Type.STATUS,this.id=data.id,data.reblog&&(Object.defineProperty(this,"rebloggedBy",{get:getProfile.bind(this,data.account.id),enumerable:!0}),data=data.reblog);return this.uri=String(data.uri),this.href=String(data.url),Object.defineProperty(this,"author",{get:getProfile.bind(this,data.account.id),enumerable:!0}),this.inReplyTo=Number(data.in_reply_to_id),this.content=String(data.content),this.datetime=new Date(data.created_at),this.reblogCount=Number(data.reblogs_count),this.favouriteCount=Number(data.favourites_count),this.isReblogged=!!data.reblogged,this.isFavourited=!!data.favourited,this.isNSFW=!!data.sensitive,this.message=String(data.spoiler_text),this.visibility={private:Post.Visibility.PRIVATE,unlisted:Post.Visibility.REBLOGGABLE,public:Post.Visibility.PUBLIC}[data.visibility]||Post.Visibility.PRIVATE,this.mediaAttachments=function(){var i,len,ref,results;for(ref=data.media_attachments,results=[],i=0,len=ref.length;i<len;i++)item=ref[i],results.push(new Attachment(item));return results}(),this.mentions=function(_this){return function(){var i,index,len,mention,mentions,ref;for(mentions=[],ref=data.mentions,index=i=0,len=ref.length;i<len;index=++i)mention=ref[index],Object.defineProperty(mentions,index,{get:getProfile.bind(_this,mention.id),enumerable:!0});return mentions}}(this)(),this.application=null!=data.application?new Application(data.application):null,Object.freeze(this)},Object.defineProperty(Post,"prototype",{value:Object.freeze({compare:function(other){return this instanceof Post&&other instanceof Post&&(this.type===other.type&&this.id===other.id&&this.reblogCount===other.reblogCount&&this.favouriteCount===other.favouriteCount&&this.isReblogged===other.isReblogged&&this.isFavourited===other.isFavourited)}})}),Post.Type=Enumeral.generate({UNKNOWN:0,STATUS:16,NOTIFICATION:32,FOLLOW:33,REACTION:48,FAVOURITE:49,REBLOG:50,MENTION:51}),Post.Visibility=Enumeral.generate({PRIVATE:0,REBLOGGABLE:1,LISTED:2,PUBLIC:3}),Laboratory.Profile=Profile=function(data,relationship){var origin,ref;if(!(this&&this instanceof Profile))throw new Error("Laboratory Error : `Profile()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Profile()` was called without any `data`");return null==relationship&&(relationship=null!=(ref=Store.profiles[data.id])?ref.relationship:void 0),data instanceof Profile?(this.id=data.id,this.username=data.username,this.account=data.account,this.localAccount=data.localAccount,this.displayName=data.displayName,this.bio=data.bio,this.href=data.href,this.avatar=data.avatar,this.header=data.header,this.isLocked=data.isLocked,this.followerCount=data.followerCount,this.followingCount=data.followingCount,this.statusCount=data.statusCount,this.relationship=data.relationship):(this.id=Number(data.id),this.username=String(data.username),this.account=String(data.acct+(null!=(origin=Store.auth.origin)&&data.acct.indexOf("@")===-1?"@"+origin:"")),this.localAccount=String(data.acct),this.displayName=String(data.display_name),this.bio=String(data.note),this.href=String(data.url),this.avatar=String(data.avatar),this.header=String(data.header),this.isLocked=!!data.locked,this.followerCount=Number(data.followers_count),this.followingCount=Number(data.following_count),this.statusCount=Number(data.statuses_count),this.relationship=data.id===Store.auth.me?Profile.Relationship.SELF:Profile.Relationship.UNKNOWN),null!=relationship&&(this.relationship=Profile.Relationship.fromValue(relationship)||this.relationship),Object.freeze(this)},Object.defineProperty(Profile,"prototype",{value:Object.freeze({compare:function(other){return this instanceof Profile&&other instanceof Profile&&(this.id===other.id&&this.relationship===other.relationship&&this.followerCount===other.followerCount&&this.followingCount===other.followingCount&&this.statusCount===other.statusCount&&this.bio===other.bio&&this.displayName===other.displayName&&this.avatar===other.avatar&&this.header===other.header&&this.isLocked===other.isLocked&&this.username===other.username&&this.localAccount===other.localAccount&&this.account===other.account&&this.href===other.href)}})}),Profile.Relationship=Enumeral.generate({NOT_FOLLOWING:0,FOLLOWER:1,FOLLOWING:2,MUTUAL:3,REQUESTED:4,REQUESTED_MUTUAL:5,BLOCKING:8,MUTING:16,MUTING_FOLLOWER:17,MUTING_FOLLOWING:18,MUTING_MUTUAL:19,MUTING_REQUESTED:20,MUTING_REQUESTED_MUTUAL:21,UNKNOWN:64,SELF:128}),Laboratory.Rolodex=Rolodex=function(data,params){var current,currentID,getProfile,i,index,j,len,prev,ref,value;if(!(this&&this instanceof Rolodex))throw new Error("Laboratory Error : `Rolodex()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Rolodex()` was called without any `data`");for(this.type=params.type instanceof Rolodex.Type?params.type:Rolodex.Type.UNDEFINED,this.query=String(params.query),isFinite(params.before)&&(this.before=Number(params.before)),isFinite(params.after)&&(this.after=Number(params.after)),getProfile=function(id){return Store.profiles[id]},data.sort(function(first,second){return second.id-first.id}),prev=null,index=i=ref=data.length-1;ref<=0?i<=0:i>=0;index=ref<=0?++i:--i)currentID=(current=data[index]).id,null==prev||currentID!==prev.id?prev=current:data.splice(index,1);for(this.profiles=[],index=j=0,len=data.length;j<len;index=++j)value=data[index],Object.defineProperty(this.profiles,index,{get:getProfile.bind(this,value.id),enumerable:!0});return Object.freeze(this.profiles),Object.freeze(this)},Object.defineProperty(Rolodex,"prototype",{value:Object.freeze({join:function(data){var combined,i,j,len,len1,profile,ref,ref1;if(!(data instanceof Profile||data instanceof Array||data instanceof Rolodex))return this;for(ref=function(){switch(!1){case!(data instanceof Profile):return[data];case!(data instanceof Rolodex):return data.profiles;default:return data}}(),i=0,len=ref.length;i<len;i++)profile=ref[i],combined=profile;for(ref1=this.profiles,j=0,len1=ref1.length;j<len1;j++)profile=ref1[j],combined.push(profile);return new Rolodex(combined,data instanceof Rolodex?data.type===this.type&&data.query===this.query?{type:this.type,query:this.query,before:function(){switch(!1){case!(data.before>=this.before):return data.before;case!(data.before<=this.before):return this.before;default:return}}.call(this),after:function(){switch(!1){case!(data.after<=this.after):return data.after;case!(data.after>=this.after):return this.after;default:return}}.call(this)}:{type:data.type===this.type?this.type:Rolodex.Type.UNDEFINED,query:"",before:void 0,after:void 0}:{type:this.type,query:this.query,before:this.before,after:this.after})},remove:function(data){var i,index,len,profile,redacted,ref;if(!(data instanceof Profile||data instanceof Array||data instanceof Rolodex))return this;for(redacted=function(){var i,len,ref,results;for(ref=this.profiles,results=[],i=0,len=ref.length;i<len;i++)profile=ref[i],results.push(profile);return results}.call(this),ref=function(){switch(!1){case!(data instanceof Profile):return[data];case!(data instanceof Rolodex):return data.profiles;default:return data}}(),i=0,len=ref.length;i<len;i++)profile=ref[i],(index=redacted.indexOf(profile))!==-1&&redacted.splice(index,1);return new Rolodex(redacted,{type:this.type,query:this.query,before:this.before,after:this.after})}})}),Rolodex.Type=Enumeral.generate({UNDEFINED:0,SEARCH:16,FOLLOWERS:33,FOLLOWING:34,FAVOURITED_BY:65,REBLOGGED_BY:69,BLOCKS:131,MUTES:132}),Laboratory.Timeline=Timeline=function(data,params){var current,currentID,getPost,i,index,isNotification,j,len,prev,ref,value;if(!(this&&this instanceof Timeline))throw new Error("Laboratory Error : `Timeline()` must be called as a constructor");if(null==data)throw new Error("Laboratory Error : `Timeline()` was called without any `data`");for(this.type=params.type instanceof Timeline.Type?params.type:Timeline.Type.UNDEFINED,this.query=String(params.query),isFinite(params.before)&&(this.before=Number(params.before)),isFinite(params.after)&&(this.after=Number(params.after)),isNotification=function(object){return!!(function(){switch(!1){case!(object instanceof Post):return object.type;case null==object.type:return Post.Type.NOTIFICATION;default:return Post.Type.STATUS}}()&Post.Type.NOTIFICATION)},getPost=function(id,isANotification){return isANotification?Store.notifications[id]:Store.statuses[id]},data.sort(function(first,second){var a,b;return isNotification(first)||isNotification(second)||(a=Number(first instanceof Post&&first.datetime||Date(first.created_at)))===(b=Number(second instanceof Post&&second.datetime||Date(second.created_at)))?second.id-first.id:2*(a>b)-1}),prev=null,index=i=ref=data.length-1;ref<=0?i<=0:i>=0;index=ref<=0?++i:--i)currentID=(current=data[index]).id,null==prev||currentID!==prev.id||isNotification(prev)!==isNotification(current)?prev=current:data.splice(index,1);for(this.posts=[],index=j=0,len=data.length;j<len;index=++j)value=data[index],Object.defineProperty(this.posts,index,{get:getPost.bind(this,value.id,isNotification(value)),enumerable:!0});return Object.freeze(this.posts),Object.freeze(this)},Object.defineProperty(Timeline,"prototype",{value:Object.freeze({join:function(data){var combined,i,j,len,len1,post,ref,ref1;if(!(data instanceof Post||data instanceof Array||data instanceof Timeline))return this;for(ref=function(){switch(!1){case!(data instanceof Post):return[data];case!(data instanceof Timeline):return data.posts;default:return data}}(),i=0,len=ref.length;i<len;i++)post=ref[i],combined=post;for(ref1=this.posts,j=0,len1=ref1.length;j<len1;j++)post=ref1[j],combined.push(post);return new Timeline(combined,data instanceof Timeline?data.type===this.type&&data.query===this.query?{type:this.type,query:this.query,before:function(){switch(!1){case!(data.before>=this.before):return data.before;case!(data.before<=this.before):return this.before;default:return}}.call(this),after:function(){switch(!1){case!(data.after<=this.after):return data.after;case!(data.after>=this.after):return this.after;default:return}}.call(this)}:{type:data.type===this.type?this.type:Timeline.Type.UNDEFINED,query:"",before:void 0,after:void 0}:{type:this.type,query:this.query,before:this.before,after:this.after})},remove:function(data){var i,index,len,post,redacted,ref;if(!(data instanceof Post||data instanceof Array||data instanceof Timeline))return this;for(redacted=function(){var i,len,ref,results;for(ref=this.posts,results=[],i=0,len=ref.length;i<len;i++)post=ref[i],results.push(post);return results}.call(this),ref=function(){switch(!1){case!(data instanceof Post):return[data];case!(data instanceof Timeline):return data.posts;default:return data}}(),i=0,len=ref.length;i<len;i++)post=ref[i],(index=redacted.indexOf(post))!==-1&&redacted.splice(index,1);return new Timeline(redacted,{type:this.type,query:this.query,before:this.before,after:this.after})}})}),Timeline.Type=Enumeral.generate({UNDEFINED:0,HASHTAG:16,LOCAL:17,GLOBAL:18,HOME:34,NOTIFICATIONS:35,FAVOURITES:36,ACCOUNT:64}),LaboratoryEvent={Events:{},Handlers:[],create:function(type,detail){return null==LaboratoryEvent.Events[type]&&(LaboratoryEvent.Events[type]={detail:Object(detail)}),LaboratoryEvent},associate:function(request,response,failure){var levent;return"object"!=typeof(levent=LaboratoryEvent.Events[request])?LaboratoryEvent:(null!=response&&(levent.response=response),null!=failure&&(levent.failure=failure),LaboratoryEvent)},handle:function(type,callback){return null==LaboratoryEvent.Events[type=String(type)]?LaboratoryEvent:(callback.type=type,LaboratoryEvent.Handlers.push(callback),LaboratoryEvent)}},Laboratory.dispatch=dispatch=function(event,props){var detail,initial,initials,levent;if(null==(levent=LaboratoryEvent.Events[event=String(event)]))return!1;if("function"==typeof(initials=levent.detail)){if(!((detail=props)instanceof initials))return!1}else{detail={};for(prop in initials)initial=initials[prop],detail[prop]=null!=props&&null!=props[prop]?props[prop]:initial}return document.dispatchEvent(new CustomEvent(event,{detail:Object.freeze(detail)})),!0},Laboratory.listen=listen=function(event,callback){return null!=LaboratoryEvent.Events[event=String(event)]&&"function"==typeof callback&&(document.addEventListener(event,callback),!0)},Laboratory.forget=forget=function(event,callback){return null!=LaboratoryEvent.Events[event=String(event)]&&"function"==typeof callback&&(document.removeEventListener(event,callback),!0)},Laboratory.request=function(event,detail){return new Promise(function(resolve,reject){var fail,failure,levent,respond,response;null!=(levent=LaboratoryEvent.Events[event])&&(respond=function(detail){return void 0!==response&&null!==response&&forget(response,respond),void 0!==failure&&null!==failure&&forget(failure,fail),resolve(detail)},fail=function(detail){return void 0!==response&&null!==response&&forget(response,respond),void 0!==failure&&null!==failure&&forget(failure,fail),reject(detail)},null!=(response=levent.response)&&listen(response,respond),null!=(failure=levent.failure)&&listen(failure,fail),dispatch(event,detail))})},LaboratoryEvent.create("LaboratoryAttachmentRequested",{file:void 0}).create("LaboratoryAttachmentReceived",Attachment).create("LaboratoryAttachmentFailed",Failure).associate("LaboratoryAttachmentRequested","LaboratoryAttachmentReceived","LaboratoryAttachmentFailed").handle("LaboratoryAttachmentRequested",function(event){var file,form,onComplete,onError;if(!("undefined"!=typeof File&&null!==File&&(file=event.detail.file)instanceof File))return void dispatch("LaboratoryAttachmentFailed",new Failure("Unable to create attachment; none provided","LaboratoryAttachmentRequested"));"undefined"!=typeof FormData&&null!==FormData||dispatch("LaboratoryAttachmentFailed",new Failure("Unable to create attachment; `FormData` is not supported on this platform")),onComplete=function(response,data,params){dispatch("LaboratoryAttachmentReceived",new Attachment(response))},onError=function(response,data,params){dispatch("LaboratoryAttachmentFailed",new Failure(response.error,"LaboratoryAttachmentRequested",params.status))},serverRequest("POST",Store.auth.origin+"/api/v1/media",(form=new FormData,form.append("file",file),form),Store.auth.accessToken,onComplete,onError)}),function(){var recalledOrigin;recalledOrigin=null,LaboratoryEvent.create("LaboratoryAuthorizationRequested",{name:"Laboratory",url:"/",redirect:"",scope:Authorization.Scope.READ}).create("LaboratoryAuthorizationReceived",Authorization).create("LaboratoryAuthorizationFailed",Failure).associate("LaboratoryAuthorizationRequested","LaboratoryAuthorizationReceived","LaboratoryAuthorizationFailed").create("LaboratoryAuthorizationGranted",{code:void 0,accessToken:void 0,origin:void 0,scope:Authorization.Scope.NONE,window:void 0}).handle("LaboratoryAuthorizationRequested",function(event){var a,accessToken,clientID,clientSecret,handleClient,makeRequest,origin,redirect,ref,scope,storedRedirect,storedScope,timeout;(scope=event.detail.scope)instanceof Authorization.Scope||(scope=Authorization.Scope.READ),a=document.createElement("a"),a.href=event.detail.url,origin=a.origin,a.href=event.detail.redirect||"",redirect=a.href,makeRequest=function(){var key,value;window.open(origin+"/oauth/authorize?"+function(){var ref,results;ref={client_id:clientID,response_type:"code",redirect_uri:redirect,scope:function(){var scopeList;return scopeList=[],scope&Authorization.Scope.READ&&scopeList.push("read"),scope&Authorization.Scope.WRITE&&scopeList.push("write"),scope&Authorization.Scope.FOLLOW&&scopeList.push("follow"),scopeList.join(" ")}()},results=[];for(key in ref)value=ref[key],results.push(encodeURIComponent(key)+"="+encodeURIComponent(value));return results}().join("&"),"LaboratoryOAuth"),recalledOrigin=origin},("undefined"!=typeof localStorage&&null!==localStorage?localStorage.getItem("Laboratory | "+origin):void 0)&&(ref=localStorage.getItem("Laboratory | "+origin).split(" ",5),storedRedirect=ref[0],clientID=ref[1],clientSecret=ref[2],storedScope=ref[3],accessToken=ref[4]),accessToken&&(scope&storedScope)==+scope&&dispatch("LaboratoryAuthorizationGranted",{accessToken:accessToken,origin:origin,scope:scope}),storedRedirect===redirect&&(scope&storedScope)==+scope&&null!=clientID&&null!=clientSecret?makeRequest():(handleClient=function(e){var client;(client=e.detail)instanceof Client&&client.origin===origin&&(scope&client.scope)==+scope&&client.redirect===redirect&&null!=client.clientID&&null!=client.clientSecret&&(clientID=client.clientID,clientSecret=client.clientSecret,scope=client.scope,localStorage.setItem("Laboratory | "+origin,[redirect,clientID,clientSecret,+scope].join(" ")),forget("LaboratoryClientReceived",handleClient),clearTimeout(timeout),makeRequest())},listen("LaboratoryClientReceived",handleClient),dispatch("LaboratoryClientRequested",{name:event.detail.name,url:origin,redirect:redirect,scope:Authorization.Scope.fromValue(scope)}),timeout=setTimeout(function(){forget("LaboratoryClientReceived",handleClient),dispatch("LaboratoryAuthorizationFailed",new Failure("Unable to authorize client","LaboratoryAuthorizationRequested"))},3e4))}).handle("LaboratoryAuthorizationGranted",function(event){var accessToken,clientID,clientSecret,code,datetime,onComplete,onError,origin,redirect,ref,scope,tokenType,verify;if(event.detail.window&&event.detail.window.close(),!(origin=event.detail.origin||recalledOrigin))return void dispatch("LaboratoryAuthorizationFailed",new Failure("Authorization data wasn't associated with an origin","LaboratoryAuthorizationRequested"));scope=event.detail.scope instanceof Authorization.Scope?function(){var scopeList;return scopeList=[],scope&Authorization.Scope.READ&&scopeList.push("read"),scope&Authorization.Scope.WRITE&&scopeList.push("write"),scope&Authorization.Scope.FOLLOW&&scopeList.push("follow"),scopeList.join(" ")}():"",datetime=NaN,tokenType="bearer",("undefined"!=typeof localStorage&&null!==localStorage?localStorage.getItem("Laboratory | "+origin):void 0)&&(ref=localStorage.getItem("Laboratory | "+origin).split(" ",5),redirect=ref[0],clientID=ref[1],clientSecret=ref[2]),verify=function(){var verifyComplete,verifyError;return verifyComplete=function(response,data,params){var scopes;dispatch("LaboratoryAuthorizationReceived",new Authorization({access_token:String(accessToken),created_at:String(+datetime),scope:scope,token_type:tokenType},origin,response.id)),localStorage.setItem("Laboratory | "+origin,[redirect,clientID,clientSecret,Authorization.Scope.READ*((scopes=scope.split(/[\s\+]+/g)).indexOf("read")!==-1)+Authorization.Scope.WRITE*(scopes.indexOf("write")!==-1)+Authorization.Scope.FOLLOW*(scopes.indexOf("follow")!==-1),accessToken].join(" ")),dispatch("LaboratoryProfileReceived",new Profile(response))},verifyError=function(response,data,params){dispatch("LaboratoryAuthorizationFailed",new Failure(response.error,"LaboratoryAuthorizationRequested",params.status))},serverRequest("GET",origin+"/api/v1/accounts/verify_credentials",null,accessToken,verifyComplete,verifyError)},(accessToken=event.detail.accessToken)?verify():(code=event.detail.code)?(onComplete=function(response,data,params){accessToken=response.access_token,datetime=new Date(response.created_at),scope=response.scope,tokenType=response.token_type,verify()},onError=function(response,data,params){dispatch("LaboratoryAuthorizationFailed",new Failure(response.error,"LaboratoryAuthorizationRequested",params.status))},serverRequest("POST",origin+"/oauth/token",{client_id:clientID,client_secret:clientSecret,redirect_uri:redirect,grant_type:"authorization_code",code:code},null,onComplete,onError)):dispatch("LaboratoryAuthorizationFailed",new Failure("No authorization code or access token was granted","LaboratoryAuthorizationRequested")),recalledOrigin=null}).handle("LaboratoryAuthorizationReceived",function(event){event.detail instanceof Authorization&&(Exposed.auth=Store.auth=event.detail)})}(),LaboratoryEvent.create("LaboratoryClientRequested",{name:"Laboratory",url:"/",redirect:"",scope:Authorization.Scope.READ}).create("LaboratoryClientReceived",Client).create("LaboratoryClientFailed",Failure).associate("LaboratoryClientRequested","LaboratoryClientReceived","LaboratoryClientFailed").handle("LaboratoryClientRequested",function(event){var a,onComplete,onError,origin,scope;return(scope=event.detail.scope)instanceof Authorization.Scope||(scope=Authorization.Scope.READ),a=document.createElement("a"),a.href=event.detail.url,origin=a.origin,a.href=event.detail.redirect||"",a.href,onComplete=function(response,data,params){dispatch("LaboratoryClientReceived",new Client(response,data,origin))},onError=function(response,data,params){dispatch("LaboratoryClientFailed",new Failure(response.error,"LaboratoryClientRequested",params.status))},serverRequest("POST",origin+"/api/v1/apps",{client_name:event.detail.name,redirect_uris:event.detail.redirect,scopes:function(){var scopeList;return scope=event.detail.scope,scopeList=[],scope&Authorization.Scope.READ&&scopeList.push("read"),scope&Authorization.Scope.WRITE&&scopeList.push("write"),scope&Authorization.Scope.FOLLOW&&scopeList.push("follow"),scopeList.join(" ")}()},null,onComplete,onError)}),LaboratoryEvent.create("LaboratoryInitializationLoaded").create("LaboratoryInitializationReady"),LaboratoryEvent.create("LaboratoryPostRequested",{id:void 0,type:Post.Type.STATUS}).create("LaboratoryPostReceived",Post).create("LaboratoryPostFailed",Failure).associate("LaboratoryPostRequested","LaboratoryPostReceived","LaboratoryPostFailed").create("LaboratoryPostCreation",{text:"",visibility:Post.Visibility.PRIVATE,inReplyTo:void 0,attachments:void 0,message:void 0,makeNSFW:!0}).create("LaboratoryPostDeletion",{id:void 0}).create("LaboratoryPostSetReblog",{id:void 0,value:!0}).create("LaboratoryPostSetFavourite",{id:void 0,value:!0}).handle("LaboratoryPostRequested",function(event){var id,isANotification,onComplete,onError,type;return isFinite(id=Number(event.detail.id))?(type=event.detail.type)instanceof Post.Type?(isANotification=type&Post.Type.Notification,isANotification||null==Store.statuses[id]||dispatch("LaboratoryPostReceived",Store.statuses[id]),isANotification&&null!=Store.notifications[id]&&dispatch("LaboratoryPostReceived",Store.notifications[id]),onComplete=function(response,data,params){var post,store;return response.id!==id?void dispatch("LaboratoryPostFailed",new Failure("Unable to fetch post; returned post did not match requested id","LaboratoryPostRequested")):(post=new Post(response),(post.type&Post.Type.NOTIFICATION)!==isANotification?void dispatch("LaboratoryPostFailed",new Failure("Unable to fetch post; returned post was not of specified type","LaboratoryPostRequested")):(store=isANotification?Store.notifications:Store.statuses,void(post.compare(store[id])||dispatch("LaboratoryPostReceived",post))))},onError=function(response,data,params){dispatch("LaboratoryPostFailed",new Failure(response.error,"LaboratoryPostRequested",params.status))},
void serverRequest("GET",Store.auth.origin+(isANotification?"/api/v1/notifications/":"/api/v1/statuses/")+id,null,Store.auth.accessToken,onComplete,onError)):void dispatch("LaboratoryPostFailed",new Failure("Unable to fetch post; no type specified","LaboratoryPostRequested")):void dispatch("LaboratoryPostFailed",new Failure("Unable to fetch post; no id specified","LaboratoryPostRequested"))}).handle("LaboratoryPostReceived",function(event){var id;event.detail instanceof Post&&event.detail.type instanceof Post.Type&&isFinite(id=Number(event.detail.id))&&((event.detail.type&Post.Type.NOTIFICATION?Store.notifications:Store.statuses)[id]=event.detail)}).handle("LaboratoryPostCreation",function(event){var attachment,attachments,inReplyTo,message,onComplete,onError;return onComplete=function(response,data,params){dispatch("LaboratoryPostReceived",new Post(response))},onError=function(response,data,params){dispatch("LaboratoryPostFailed",new Failure(response.error,"LaboratoryPostCreation",params.status))},serverRequest("POST",Store.auth.origin+"/api/v1/statuses/",{status:event.detail.text,in_reply_to_id:(inReplyTo=event.detail.inReplyTo)>0&&isFinite(inReplyTo)?inReplyTo:void 0,media_ids:(attachments=event.detail.attachments)instanceof Array?function(){var i,len,results;for(results=[],i=0,len=attachments.length;i<len;i++)(attachment=attachments[i])instanceof Attachment&&results.push(attachment.id);return results}():void 0,sensitive:event.detail.makeNSFW?"true":void 0,spoiler_text:(message=event.detail.message)?String(message):void 0,visibility:function(){switch(event.detail.visibility){case Post.Visibility.PUBLIC:return"public";case Post.Visibility.REBLOGGABLE:return"unlisted";default:return"private"}}()},Store.auth.accessToken,onComplete,onError)}).handle("LaboratoryPostDeletion",function(event){var id,onComplete,onError;return isFinite(id=Number(event.detail.id))?(onComplete=function(){},onError=function(response,data,params){dispatch("LaboratoryPostFailed",new Failure(response.error,"LaboratoryPostDeletion",params.status))},serverRequest("DELETE",Store.auth.origin+"/api/v1/statuses/"+id,null,Store.auth.accessToken,onComplete,onError)):void dispatch("LaboratoryPostFailed",new Failure("Unable to delete post; no id specified","LaboratoryPostDeletion"))}).handle("LaboratoryPostSetReblog",function(event){var id,onComplete,onError,ref,value;null!=(value=!!event.detail.value)&&isFinite(id=Number(event.detail.id))||dispatch("LaboratoryPostFailed",new Failure("Cannot set reblog status for post: Either value or id is missing","LaboratoryPostSetReblog")),onComplete=function(response,data,params){dispatch("LaboratoryPostReceived",new Post(response))},onError=function(response,data,params){dispatch("LaboratoryPostFailed",new Failure(response.error,"LaboratoryPostSetReblog",params.status))},(null!=(ref=Store.statuses[id])?ref.isReblogged:void 0)!==value&&serverRequest("POST",Store.auth.origin+"/api/v1/statuses/"+id+(value?"/reblog":"/unreblog"),null,Store.auth.accessToken,onComplete,onError)}).handle("LaboratoryPostSetFavourite",function(event){var id,onComplete,onError,ref,value;null!=(value=!!event.detail.value)&&isFinite(id=Number(event.detail.id))||dispatch("LaboratoryPostFailed",new Failure("Cannot set favourite status for post: Either value or id is missing","LaboratoryPostSetFavourite")),onComplete=function(response,data,params){dispatch("LaboratoryPostReceived",new Post(response))},onError=function(response,data,params){dispatch("LaboratoryPostFailed",new Failure(response.error,"LaboratoryPostSetFavourite",params.status))},(null!=(ref=Store.statuses[id])?ref.isFavourited:void 0)!==value&&serverRequest("POST",Store.auth.origin+"/api/v1/statuses/"+id+(value?"/favourite":"/unfavourite"),null,Store.auth.accessToken,onComplete,onError)}),LaboratoryEvent.create("LaboratoryProfileRequested",{id:void 0,requestRelationships:!0}).create("LaboratoryProfileReceived",Profile).create("LaboratoryProfileFailed",Failure).associate("LaboratoryProfileRequested","LaboratoryProfileReceived","LaboratoryProfileFailed").create("LaboratoryProfileSetRelationship",{id:void 0,relationship:void 0}).handle("LaboratoryProfileRequested",function(event){var id,onComplete,onError,onRelationshipsComplete;if(!isFinite(id=Number(event.detail.id)))return void dispatch("LaboratoryProfileFailed",new Failure("Unable to fetch profile; no id specified","LaboratoryProfileRequested"));null!=Store.profiles[id]&&dispatch("LaboratoryProfileReceived",Store.profiles[id]),onComplete=function(response,data,params){var profile;if(response.id!==id)return void dispatch("LaboratoryProfileFailed",new Failure("Unable to fetch profile; returned profile did not match requested id","LaboratoryProfileRequested"));profile=new Profile(response),profile.compare(Store.profiles[id])||dispatch("LaboratoryProfileReceived",profile),event.detail.requestRelationships&&serverRequest("GET",Store.auth.origin+"/api/v1/accounts/relationships",{id:id},Store.auth.accessToken,onRelationshipsComplete,onError)},onRelationshipsComplete=function(response,data,params){var ref,relationship,relationships;relationships=response[0],(null!=(ref=Store.profiles[id])?ref.relationship:void 0)!==(relationship=Profile.Relationship.fromValue(Profile.Relationship.FOLLOWER*relationships.followed_by+Profile.Relationship.FOLLOWING*relationships.following+Profile.Relationship.REQUESTED*relationships.requested+Profile.Relationship.BLOCKING*relationships.blocking+Profile.Relationship.MUTING*relationships.muting+Profile.Relationship.SELF*(relationships.id===Store.auth.me)||Profile.Relationship.UNKNOWN))&&dispatch("LaboratoryProfileReceived",new Profile(Store.profiles[id],relationship))},onError=function(response,data,params){dispatch("LaboratoryProfileFailed",new Failure(response.error,"LaboratoryProfileRequested",params.status))},serverRequest("GET",Store.auth.origin+"/api/v1/accounts/"+id,null,Store.auth.accessToken,onComplete,onError)}).handle("LaboratoryProfileReceived",function(event){var id;event.detail instanceof Profile&&isFinite(id=Number(event.detail.id))&&(Store.profiles[id]=event.detail)}).handle("LaboratoryProfileSetRelationship",function(event){var changes,id,onComplete,onError,profile,relationship;(relationship=event.detail.relationship)instanceof Profile.Relationship&&isFinite(id=Number(event.detail.id))||dispatch("LaboratoryProfileFailed",new Failure("Cannot set relationship for account: Either relationship or id is missing","LaboratoryProfileSetRelationship")),onComplete=function(response,data,params){dispatch("LaboratoryProfileReceived",new Profile(response))},onError=function(response,data,params){dispatch("LaboratoryProfileFailed",new Failure(response.error,"LaboratoryProfileSetRelationship",params.status))},(profile=Store.profiles[id])instanceof Profile?(changes=profile.relationship^relationship,changes&Profile.FOLLOWING?serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.FOLLOWING?"/follow":"/unfollow"),null,Store.auth.accessToken,onComplete,onError):changes&Profile.REQUESTED&&serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.REQUESTED?"/follow":"/unfollow"),null,Store.auth.accessToken,onComplete,onError),changes&Profile.BLOCKING&&serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.BLOCKING?"/block":"/unblock"),null,Store.auth.accessToken,onComplete,onError),changes&Profile.MUTING&&serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.MUTING?"/mute":"/unmute"),null,Store.auth.accessToken,onComplete,onError)):(serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.FOLLOWING||relationship&Profile.REQUESTED?"/follow":"/unfollow"),null,Store.auth.accessToken,onComplete,onError),serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.BLOCKING?"/block":"/unblock"),null,Store.auth.accessToken,onComplete,onError),serverRequest("POST",Store.auth.origin+"/api/v1/accounts/"+id+(relationship&Profile.MUTING?"/mute":"/unmute"),null,Store.auth.accessToken,onComplete,onError))}),LaboratoryEvent.create("LaboratoryRequestOpen",XMLHttpRequest).create("LaboratoryRequestUpdate",XMLHttpRequest).create("LaboratoryRequestComplete",XMLHttpRequest).create("LaboratoryRequestError",XMLHttpRequest),LaboratoryEvent.create("LaboratoryRolodexRequested",{type:Rolodex.Type.SEARCH,query:"",before:void 0,after:void 0,limit:void 0}).create("LaboratoryRolodexReceived",Rolodex).create("LaboratoryRolodexFailed",Failure).associate("LaboratoryRolodexRequested","LaboratoryRolodexReceived","LaboratoryRolodexFailed").handle("LaboratoryRolodexRequested",function(event){var after,before,limit,onComplete,onError,query,type;if(query=String(event.detail.query),isFinite(limit=Number(event.detail.limit))||(limit=null),isFinite(before=Number(event.detail.before))||(before=null),isFinite(after=Number(event.detail.after))||(after=null),!((type=event.detail.type)instanceof Rolodex.Type&&type!==Rolodex.Type.UNDEFINED))return void dispatch("LaboratoryRolodexFailed",new Failure("Unable to fetch rolodex; no type specified","LaboratoryRolodexRequested"));onComplete=function(response,data,params){var account,i,ids,len;for(ids=[],i=0,len=response.length;i<len;i++)account=response[i],ids.indexOf(account.id)===-1&&ids.push(account.id)&&dispatch("LaboratoryProfileReceived",account);dispatch("LaboratoryRolodexReceived",new Rolodex(response,{type:type,query:query,before:(params.prev.match(/.*since_id=([0-9]+)/)||[])[1],after:(params.next.match(/.*max_id=([0-9]+)/)||[])[1]}))},onError=function(response,data,params){dispatch("LaboratoryRolodexFailed",new Failure(response.error,"LaboratoryRolodexRequested",params.status))},serverRequest("GET",Store.auth.origin+function(){switch(type){case Rolodex.Type.SEARCH:return"/api/v1/accounts/search";case Rolodex.Type.FOLLOWERS:return"/api/v1/accounts/"+query+"/followers";case Rolodex.Type.FOLLOWING:return"/api/v1/accounts/"+query+"/following";case Rolodex.Type.FAVOURITED_BY:return"/api/v1/statuses/"+query+"/favourited_by";case Rolodex.Type.REBLOGGED_BY:return"/api/v1/statuses/"+query+"/reblogged_by";case Rolodex.Type.BLOCKS:return"/api/v1/blocks";case Rolodex.Type.MUTES:return"/api/v1/mutes";default:return"/api/v1"}}(),function(){switch(type){case Rolodex.Type.SEARCH:return{q:query,limit:limit};case Rolodex.Type.FOLLOWERS:case Rolodex.Type.FOLLOWING:case Rolodex.Type.FAVOURITED_BY:case Rolodex.Type.REBLOGGED_BY:case Rolodex.Type.BLOCKS:case Rolodes.Type.MUTES:return{max_id:before,since_id:after};default:return null}}(),Store.auth.accessToken,onComplete,onError)}),LaboratoryEvent.create("LaboratoryTimelineRequested",{type:Timeline.Type.HOME,query:"",before:void 0,after:void 0}).create("LaboratoryTimelineReceived",Timeline).create("LaboratoryTimelineFailed",Failure).associate("LaboratoryTimelineRequested","LaboratoryTimelineReceived","LaboratoryTimelineFailed").handle("LaboratoryTimelineRequested",function(event){var after,before,onComplete,onError,query,type;if(query=String(event.detail.query),isFinite(before=Number(event.detail.before))||(before=null),isFinite(after=Number(event.detail.after))||(after=null),!((type=event.detail.type)instanceof Timeline.Type&&type!==Timeline.Type.UNDEFINED))return void dispatch("LaboratoryTimelineFailed",new Failure("Unable to fetch timeline; no type specified","LaboratoryTimelineRequested"));onComplete=function(response,data,params){var account,acctIDs,i,ids,j,k,len,len1,len2,mention,mentionIDs,mentions,ref,ref1,ref2,status;for(acctIDs=[],mentions=[],mentionIDs=[],ids=[],i=0,len=response.length;i<len;i++)if(status=response[i],ids.indexOf(status.id)===-1&&ids.push(status.id)){if(acctIDs.indexOf(status.account.id)===-1&&acctIDs.push(status.account.id)&&dispatch("LaboratoryProfileReceived",new Profile(status.account)),null!=(null!=(ref=status.status)?ref.account:void 0)&&acctIDs.indexOf(status.status.account.id)===-1&&acctIDs.push(status.status.account.id)&&dispatch("LaboratoryProfileReceived",new Profile(status.status.account)),null!=(null!=(ref1=status.reblog)?ref1.account:void 0)&&acctIDs.indexOf(status.reblog.account.id)===-1&&acctIDs.push(status.reblog.account.id)&&dispatch("LaboratoryProfileReceived",new Profile(status.reblog.account)),status.mentions instanceof Array)for(ref2=status.mentions,j=0,len1=ref2.length;j<len1;j++)account=ref2[j],mentionIDs.indexOf(account.id)===-1&&(mentionIDs.push(account.id),mentions.push(account));dispatch("LaboratoryPostReceived",new Post(status))}for(k=0,len2=mentions.length;k<len2;k++)mention=mentions[k],acctIDs.indexOf(mention.id)===-1&&null==Store.profiles[mention.id]&&dispatch("LaboratoryProfileReceived",new Profile(mention));dispatch("LaboratoryTimelineReceived",new Timeline(response,{type:type,query:query,before:(params.prev.match(/.*since_id=([0-9]+)/)||[])[1],after:(params.next.match(/.*max_id=([0-9]+)/)||[])[1]}))},onError=function(response,data,params){dispatch("LaboratoryTimelineFailed",new Failure(response.error,"LaboratoryTimelineRequested",params.status))},serverRequest("GET",Store.auth.origin+function(){switch(type){case Timeline.Type.HASHTAG:return"/api/v1/timelines/tag/"+query;case Timeline.Type.LOCAL:return"/api/v1/timelines/public";case Timeline.Type.GLOBAL:return"/api/v1/timelines/public";case Timeline.Type.HOME:return"/api/v1/timelines/home";case Timeline.Type.NOTIFICATIONS:return"/api/v1/notifications";case Timeline.Type.FAVOURITES:return"/api/v1/favourites";case Timeline.Type.ACCOUNT:return"/api/v1/accounts/"+query+"/statuses";default:return"/api/v1"}}(),function(){switch(type){case Timeline.Type.LOCAL:return{local:!0,max_id:before,since_id:after};default:return{max_id:before,since_id:after}}}(),Store.auth.accessToken,onComplete,onError)}),Store={auth:null,notifications:{},profiles:{},statuses:{}},window["🏪"]=Store,Object.defineProperty(window,"Laboratory",{value:Object.freeze(Laboratory),enumerable:!0}),dispatch("LaboratoryInitializationLoaded"),run=function(){var handler,i,len,ref;for(ref=LaboratoryEvent.Handlers,i=0,len=ref.length;i<len;i++)handler=ref[i],listen(handler.type,handler);Exposed.ready=!0,dispatch("LaboratoryInitializationReady")},"complete"===document.readyState?run():window.addEventListener("load",run)}).call(this);